\documentclass[10pt, a4paper]{article}
% especifico márgenes manualmente
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
% codificación ISO-8859-1
\usepackage[latin1]{inputenc}
% separación silábica en castellano
\usepackage[spanish]{babel}
% paquetes y caratula de algo2
\usepackage{aed2-symb,aed2-itef,aed2-tad,caratula}

\begin{document}

% Estos comandos deben ir antes del \maketitle
\materia{Algoritmos y Estructuras de Datos II} % obligatorio
\submateria{Segundo Cuatrimestre de 2015} % opcional
\titulo{Trabajo Práctico 1} % obligatorio
\subtitulo{Especificación Alta Seguridad nos cuida} % opcional
\grupo{Grupo 24} % opcional 


\integrante{Fernando Frassia}{340/13}{ferfrassia@gmail.com} % obligatorio 
\integrante{Sebastian Matias Giambastiani}{916/12}{sebastian.giambastiani@hotmail.com}
\integrante{}{}{}
\integrante{}{}{}



\maketitle

% compilar 2 veces para actualizar las referencias
\tableofcontents

\pagebreak
\newpage


 

%RenombresBegin
\section{Renombres}

\tadNombre{ID} es \tadNombre{Nat}

\tadNombre{Chabon} es \tadNombre{Nat}

\tadNombre{(0,1,2)} es \tadNombre{Poli, Estudiante, Hippie}

%\tadNombre{Paquete} es \tadNombre{Tupla(Nat, Nat), el $\pi$$_1$ de la tupla es la prioridad del paquete, y el $\pi$$_2$ es su identificador personal}

%\tadNombre{} es \tadNombre{}
%RenombresEnd

%TADSBegin

%SecuExtendidoBegin



%\end{tad}
%SecuExtendidoEnd
\newpage

%RedBegin
\section{TAD \tadNombre{Grilla}}

\begin{tad}{\tadNombre{Grilla}}
\tadIgualdadObservacional{g1}{g2}{Grilla}{}
\tadGeneros{Grilla}


\tadExporta{Grila, generadores, observadores}
%\tadUsa{\tadNombre{Bool}, \tadNombre{Conj($\alpha$)}, \tadNombre{Compu}, \tadNombre{Interfaz}, \tadNombre{Secu($\alpha$)}}

\tadObservadores
\tadAlinearFunciones{libre?}{Nat/i, Nat/j, Grilla/g}
\tadOperacion{libre?}{Nat/i, Nat/j, Grilla/g}{Bool}{enRango(i,j,g)}
\tadOperacion{tam}{Grilla}{(Nat, Nat)}{}


\tadGeneradores
\tadAlinearFunciones{obstaculizar}{Nat/i, Nat/j, Grilla/g}
\tadOperacion{crear}{Nat/l, Nat/a}{Grilla}{}
\tadOperacion{obstaculizar}{Nat/i, Nat/j, Grilla/g}{Grilla}{enRango(i,j,g) $\yluego$ libre?(i,j,g)}

\tadOtrasOperaciones
\tadAlinearFunciones{posLibresAux}{Nat/i, Nat/j, Nat/l, Nat/a, Grilla/g}

\tadOperacion{enRango}{Nat/i, Nat/j, Grilla/g}{Bool}{}

\tadOperacion{posLibres}{Grilla}{Conj(Nat, Nat)}{}

\tadOperacion{posLibresAux}{Nat/i, Nat/j, Nat/l, Nat/a, Grilla/g}{Conj(Nat, Nat)}{}
  

\tadAxiomas[]
\tadAlinearAxiomas{libre?(i, j, obstaculizar(k, l, g))}

\tadAxioma{libre?(i, j, crear(l, a, cid))}{True}

\tadAxioma{libre?(i, j, obstaculizar(k, l, g))}{\IF i = k $\wedge$ j = l THEN False ELSE libre?(i, j, g) FI}

\tadAxioma{tam(crear(l, a, cid))}{(l, a)}

\tadAxioma{tam(obstaculizar(i, j, g))}{tam(g)}

\tadAxioma{enRango(i, j, g)}{i $\leq$ tam(g).$\pi$$_1$ $\wedge$ j $\leq$ tam(g).$\pi$$_2$}

\tadAxioma{posLibres(g)}{posLibresAux(1, 1, tam(g).$\pi$$_1$, tam(g).$\pi$$_2$, g)}

\tadAxioma{posLibresAux(i, j, l, a, g)}{\IF j $\leq$ a THEN 
								{\IF i $\leq$ l THEN 
									{\IF libre?(i, j, g) THEN 
										Ag((i, j), posLibresAux(i+1, j, l, a, g)) 
									ELSE 
										posLibresAux(i+1, j, l, a, g) FI} 
								ELSE 
									posLibresAux(1, j+1, l, a, g) FI} 
							ELSE 
								$\emptyset$ FI}



\end{tad}
%RedEnd

\newpage

%DCNetBegin
\section{TAD \tadNombre{Sistema}}

\begin{tad}{\tadNombre{Sistema}}
\tadIgualdadObservacional{s1}{s2}{Sistema}{}
\tadGeneros{Sistema}

\tadExporta{Sistema, generadores, observadores}
%\tadUsa{\tadNombre{Red}, \tadNombre{Secu($\alpha$)}, \tadNombre{Conjunto($\alpha$)}, \tadNombre{Nat}, \tadNombre{Bool}, \tadNombre{Paquete}, \tadNombre{Tupla}}

\tadObservadores
\tadAlinearFunciones{infraccionesDe}{Chabon/c, Sistema/s}
\tadOperacion{laGrilla}{Sistema}{Grilla}{}
\tadOperacion{gente}{Sistema}{Conj(Chabon)}{}
\tadOperacion{rol}{Chabon/c, Sistema/s}{String}{c $\in$ gente(s)}
\tadOperacion{pos}{Chabon/c, Sistema/s}{(Nat, Nat)}{c $\in$ gente(s)}
\tadOperacion{infraccionesDe}{Chabon/c, Sistema/s}{Nat}{c $\in$ gente(s) $\yluego$ rol(c, s) = policia}
\tadOperacion{capturasDe}{Chabon/c, Sistema/s}{Nat}{c $\in$ gente(s) $\yluego$ rol(c, s) = policia}


\tadGeneradores
\tadAlinearFunciones{moverNoEst}{Chabon/c, Bool/b, Nat/i, Nat/j, Sistema/s}
\tadOperacion{rastrillar}{Conj(Chabon)/cc, Grilla/g}{Sistema}{$\#$cc $\leq$ $\#$posLibres(g)}
\tadOperacion{entraNoPoli}{Chabon/c, String/r, Nat/i, Nat/j, Sistema/s}{Sistema}{c $\notin$ gente(s) $\wedge$ (i, j) $\in$ posLibresSist(s) $\wedge$ (r = estudiante $\vee$ r = hippie) $\wedge$ (j = 1 $\vee$ j = tam(laGrilla(s)).$\pi$$_2$)}
\tadOperacion{moverEst}{Chabon/c, Nat/i, Nat/j, Sistema/s}{Sistema}{c $\in$ gente(s) $\yluego$ rol(c, s) = estudiante $\wedge$ \tadNombre{va a una pos libre}}
\tadOperacion{moverNoEst}{Chabon/c, Sistema/s}{Sistema}{c $\in$ gente(s) $\yluego$ rol(c, s) $\neq$ estudiante $\wedge$ (rol(c, s) = policia $\impluego$ sePuedeMover?(c, s))}


\tadOtrasOperaciones
\tadAlinearFunciones{acorraladoPorEstudiantes?}{Chabon/c, Conj(Nat, Nat)/ca, Conj(Nat, Nat)/ch, Nat, Sistema/s}
\tadOperacion{posLibresSist}{Sistema}{Conj(Nat, Nat)}{}
\tadOperacion{cantHippies}{Sistema}{Nat}{}
\tadOperacion{cantEstudiantes}{Sistema}{Nat}{}
\tadOperacion{masVigilante}{Sistema}{Chabon}{}
\tadOperacion{sePuedeMover?}{Chabon/c, Sistema/s}{Bool}{c $\in$ gente(s) $\yluego$ rol(c, s) = policia}
\tadOperacion{distancia}{Chabon/c1, Chabon/c2, Sistema/s}{Nat}{$\{$$c_1$, $c_2$$\}$ $\subseteq$ gente(s)}
\tadOperacion{distanciaAux}{Nat/i_1, Nat/j1, Nat/i2, Nat/j2, Sistema/s}{Nat}{enRango(i1, j1, s) $\wedge$ enRango(i2, j2, s)}
\tadOperacion{acorraladoPorHippies?}{Chabon/c, Sistema/s}{Bool}{c $\in$ gente(s) $\yluego$ rol(c, s) = estudiante}
\tadOperacion{acorraladoPorHippiesAux?}{Chabon/c, Conj(Nat, Nat)/ca, Conj(Nat, Nat)/ch, Nat, Sistema/s}{Nat}{c $\in$ gente(s) $\yluego$ rol(c, s) = estudiante $\wedge$ 
($\forall$ p $\in$ ca $\cup$ ch) enRango(p.$\pi$$_1$, p.$\pi$$_2$, s)}
\tadOperacion{acorraladoPorEstudiantes?}{Chabon/c, Sistema/s}{Bool}{c $\in$ gente(s) $\yluego$ rol(c, s) = hippie}
\tadOperacion{posDeHippies}{Sistema}{Conj(Nat, Nat)}{}
\tadOperacion{posDeHippiesAux}{Conj(Chabones)/cc, Sistema/s}{Conj(Nat, Nat)}{cc $\subseteq$ gente(s)}

\tadAxiomas[]
\tadAlinearAxiomas{acorraladoPorEstudiantes?(c, s)}

\tadAxioma{laGrilla(rastrillar(cc, g))}{g}
\tadAxioma{laGrilla(entraNoPoli(c, r, i, j, s))}{laGrilla(s)}
\tadAxioma{laGrilla(moverEst(c, i, j, s))}{laGrilla(s)}
\tadAxioma{laGrilla(moverNoEst(c, s))}{laGrilla(s)}

\tadAxioma{gente(rastrillar(cc, g))}{cc}
\tadAxioma{gente(entraNoPoli(c, b, i, j, s))}{c $\cup$ gente(s)}
\tadAxioma{gente(moverEst(c, i, j, s))}{\IF i = 0 $\vee$ i = tam(laGrilla(s)).$\pi$$_2$ + 1 THEN gente(s) - $\{$c$\}$ ELSE gente(s) FI}
\tadAxioma{gente(moverNoEst(c, s))}{gente(s)}

\tadAxioma{rol(c, rastrillar(cc, g))}{policia}
\tadAxioma{rol($c_1$, entraNoPoli($c_2$, r, i, j, s))}{\IF $c_1$ $\neq$ $c_2$ THEN rol($c_1$, s) ELSE r FI}
\tadAxioma{rol($c_1$, moverEst($c_2$, i, j, s))}{\IF rol($c_1$, s) = estudiante THEN
										{\IF acorraladoPorHippies?($c_1$, mover(Est($c_2$, i, j, s))) THEN 
											hippie 
										ELSE
											rol($c_1$, s) FI} 
									ELSE
										{\IF rol($c_1$, s) = hippie THEN
											{\IF acorraladoPorEstudiantes?($c_1$, moverEst($c_2$, i, j, s)) THEN
												estudiante
											ELSE
												rol($c_1$, s) FI}
										ELSE
											rol($c_1$, s) FI} 
									FI}
\tadAxioma{rol($c_1, $moverNoEst($c_2$, s))}{HAY QUE CONSULTAR}

\tadAxioma{pos(c, rastrillar(conj, g))} {
	dameUno(posLibres(g))
}

\tadAxioma{pos(c, entraNoPoli(ch, r, i, j, s))} {
	\IF c = ch THEN
		(i, j)
	ELSE
		pos(c, s)
	FI
}

\tadAxioma{pos(c, moverEst(ch, x, i, s))} {
	\IF c = ch THEN
		(x, i)
	ELSE
		pos(c, s)
	FI
}

\tadAxioma{pos(c, moverNoEst(ch, s))} {
	\IF c = ch THEN
	{
		dameUno(targetsMasCercanos(c, targets(rol(c, s), gente(s), s), {}, s))
	}
	ELSE
		pos(c, s)
	FI
}

\tadAxioma{targets(r, g, s)} {
	\IF $\emptyset$?(g) THEN
		$\emptyset$	
	ELSE
	{
		\IF (r = hippie $\wedge$ rol(dameUno(g), s) = estudiante) $\vee$ (r = poli $\wedge$ rol(dameUno(g), s) = hippie) THEN
			{dameUno(g)} $\cup$ targets(r, sinUno(g), s)
		ELSE
			targets(p, r, sinUno(g), s)
		FI}
	FI
}

\tadAxioma{targetsMasCercanos(c, t, tc, s)} {
	\IF $\emptyset$?(t) THEN
		tc
	ELSE
	{
		\IF $\emptyset$?(tc) THEN
			targetsMasCercanos(c, sinUno(t), dameUno(t) $\cup$ tc, s)
		ELSE
		{
			\IF distancia(c, dameUno(t), s) < distancia(c, dameUno(tc), s) THEN
				targetsMasCercanos(c, sinUno(t), {dameUno(t)}, s)
			ELSE
			{
				\IF distancia(c, dameUno(t), s) = distancia(c, dameUno(tc), s) THEN
					targetsMasCercanos(c, sinUno(t), tc $\cup$ dameUno(t), s)
				ELSE
				FI
			}
			FI
		}
		FI
	}
	FI
}

\tadAxioma{distancia(c1, c2, s)}{distanciaAux(pos($c_1$).$\pi$$_1$, pos($c_1$).$\pi$$_2$, pos($c_2$).$\pi$$_1$, pos($c_2$).$\pi$$_2$, s)}	
\tadAxioma{distanciaAux($i_1$, $j_1$, $i_2$, $j_2$, s)}{\IF $i_1$ $\geq$ $i_2$ THEN 
											{\IF $j_1$ $\geq$ $j_2$ THEN
												$i_1$ - $i_2$ + $j_1$ - $j_2$ 
											ELSE
												distancia($i_1$, $j_2$, $i_2$, $j_1$)
											FI}
										ELSE
											distancia($i_2$, $j_1$, $i_1$, $j_2$)
										FI}
								
	
\tadAxioma{acorraladoPorHippies?(c, s)}{acorraladoPorAux?(c, adyacentes(c, s), posDeHippies(s), 0, s) $\geq$ 2}
\tadAxioma{acorraladoAux?(c, ca, ch, n, s)}{$\#$ ca INTERSECCION ch}

\tadAxioma{acorraladoPorEstudiantes?(c, s)}{acorraladoAux?(c, adyacentes(c, s), posDeEstudiantes(s), 0, s) = 4}


\tadAxioma{posDeHippies(s)}{posDeHippiesAux(gente(s), s)}
\tadAxioma{posDeHippiesAux(cc, s)}{\IF $\emptyset$?(cc) THEN
								$\emptyset$
							ELSE 
								{\IF rol(dameUno(cc), s) = hippie THEN
									Ag(pos(dameUno(cc), s), posDeHippiesAux(sinUno(cc), s))
								ELSE
									posDeHippiesAux(sinUno(cc), s) 
								FI}
							FI}




\end{tad}


\end{document}
